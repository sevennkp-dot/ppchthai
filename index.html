<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ö‡∏≤‡∏∞‡πÅ‡∏™‡∏Å‡∏≤‡∏£‡∏ó‡∏∏‡∏à‡∏£‡∏¥‡∏ï‡πÅ‡∏´‡πà‡∏á‡∏ä‡∏≤‡∏ï‡∏¥</title>
  <script src="https://cdn.tailwindcss.com">// ‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠/‡∏ï‡∏≥‡∏ö‡∏•‡∏à‡∏≤‡∏Å Supabase
(async function(){
  const supabase = window.supabase.createClient("YOUR_SUPABASE_URL", "YOUR_PUBLIC_ANON_KEY");

  const provinceSelect = document.getElementById('province');
  const districtSelect = document.getElementById('district');
  const subdistrictSelect = document.getElementById('subdistrict');

  // ‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
  const { data: provinces } = await supabase.from('provinces').select('*');
  provinceSelect.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î --</option>' +
    provinces.map(p => `<option value="${p.id}">${p.name_th}</option>`).join('');(p => `<option value="${p.id}">${p.name}</option>`).join('');

  // ‡πÇ‡∏´‡∏•‡∏î‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
  provinceSelect.addEventListener('change', async () => {
    districtSelect.innerHTML = '<option value="">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</option>';
    const { data: districts } = await supabase.from('districts').select('*').eq('proince_id', provinceSelect.value);

    districtSelect.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ --</option>' +
      districts.map(d => `<option value="${d.id}">${d.name_th}</option>`).join('');(d => `<option value="${d.id}">${d.name}</option>`).join('');

    subdistrictSelect.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡∏ö‡∏• --</option>';
  });

  // ‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏≥‡∏ö‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≥‡πÄ‡∏†‡∏≠
  districtSelect.addEventListener('change', async () => {
    subdistrictSelect.innerHTML = '<option value="">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</option>';
    const { data: subs } = await supabase.from('tambon').select('*').eq('district_id', districtSelect.value);

    subdistrictSelect.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡∏ö‡∏• --</option>' +
      subs.map(s => `<option value="${s.id}">${s.name_th}</option>`).join('');(s => `<option value="${s.id}">${s.name}</option>`).join('');
  });
})();

</script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    :root{--bg:#f5f7fa;--primary:#1E3A8A;--accent:#0EA5E9;}
    html,body{height:100%;}
    body{background:linear-gradient(180deg,#f8fafc 0%, #fff 100%);font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,'Helvetica Neue',Arial;}
    .loading{display:inline-block;width:18px;height:18px;border:3px solid #f3f3f3;border-top:3px solid var(--primary);border-radius:50%;animation:spin 1s linear infinite}
    @keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
    /* toast */
    .toast{position:fixed;left:50%;transform:translateX(-50%) translateY(-10px);top:18px;z-index:60;padding:10px 16px;border-radius:10px;color:white;font-weight:600;opacity:0;transition:all .28s ease;backdrop-filter: blur(4px)}
    .toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
    /* highlight animation for new items */
    .pulse-highlight{animation:pulse 2s ease-in-out; border-color:#fde68a}
    @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(253,230,138,0.0)}50%{box-shadow:0 6px 18px -6px rgba(253,230,138,0.6)}100%{box-shadow:0 0 0 0 rgba(253,230,138,0.0)}}
    * { box-sizing: border-box; }
  html, body { margin: 0; padding: 0; width: 100%; height: 100%; }
  body { display: flex; flex-direction: column; min-height: 100vh; }
</style>
</head>
<body class="min-h-screen text-gray-800">

  <main class="w-full max-w-full md:max-w-2xl mx-auto p-4">

    <!-- Top header / brand -->
    <header class="mt-3 mb-3 flex items-center gap-3">
      <div class="w-12 h-12 rounded-3xl bg-[000000] flex items-center justify-center shadow-md">
        <img src="https://yoauscrafbucdahwlvmc.supabase.co/storage/v1/object/sign/pic/logo.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82YzU0ZjkzMi04YzdhLTQ2OGQtOTI3OC0wZGMyNjBlNGRlYWYiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJwaWMvbG9nby5wbmciLCJpYXQiOjE3NjM3MjQ0MDQsImV4cCI6NDkxNzMyNDQwNH0.RZSux7PsSQe2ekfKxmJrQ-PhxmvQ-2QGiEJCt465GRQ" class="w-24 h-24 object-contain" />
      </div>
      <div>
        <h1 class="text-xl font-extrabold">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‡∏õ.‡∏õ.‡∏ä</h1>
        <p class="text-sm text-gray-600">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Ñ‡∏ì‡∏∞‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏≤‡∏ö‡∏õ‡∏£‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏∏‡∏à‡∏£‡∏¥‡∏ï‡πÅ‡∏´‡πà‡∏á‡∏ä‡∏≤‡∏ï‡∏¥</p>
      </div>
    </header>

    <!-- Primary card: emergency form -->
    <section id="reportCard" class="bg-white rounded-2xl shadow-2xl border border-gray-200 p-5 mb-5">
    
      <div class="mb-4">

        
        <h2 class="text-lg font-bold">‡πÅ‡∏à‡πâ‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏∏‡∏à‡∏£‡∏¥‡∏ï</h2>
        <p class="text-sm text-gray-600 mt-1">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</p>
      </div>

       <div class="p-4 rounded-2xl bg-gray-50 border border-gray-200 shadow-sm">
  <span class="block text-sm font-semibold text-gray-800">‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà <span class="text-red-600">*</span></span> <span class="text-red-600">*</span></span>
  <div class="mt-2 flex flex-col gap-2">
    <label class="inline-flex items-center gap-2">
      <input type="radio" name="identify" value="yes" class="w-4 h-4" required>
      <span>‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</span>
    </label>
    <label class="inline-flex items-center gap-2">
      <input type="radio" name="identify" value="no" class="w-4 h-4">
      <span>‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</span>
    </label>
  </div>

  <!-- Case ID Display (better styled) -->
  <div class="mt-4 p-4 bg-blue-50 border border-blue-300 rounded-2xl shadow-sm">
    <label class="block text-sm font-semibold text-blue-900">‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</label>
    <div class="flex items-center gap-2 mt-2">
      <input id="caseIdDisplay" type="text" readonly class="flex-1 rounded-xl border px-4 py-2 bg-white font-semibold text-blue-700 shadow-sm" />
      <button type="button" id="copyCaseIdBtn" class="px-3 py-2 rounded-xl bg-blue-600 hover:bg-blue-700 text-white text-sm font-semibold">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
    </div>
    <input type="hidden" id="caseIdInput" name="case_id" />
  </div>
</div>
</div>
</div>

      
      <form id="emergencyForm" class="space-y-4" novalidate>

        <div>
          <label for="inputName" class="block text-sm font-medium text-gray-700">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span class="text-red-600">*</span></label>
          <input id="inputName" name="name" type="text" required class="mt-1 block w-full rounded-2xl border px-4 py-3 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#1E3A8A]" placeholder="‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ">
        </div>

        <div>
          <label for="inputPhone" class="block text-sm font-medium text-gray-700">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå <span class="text-red-600">*</span></label>
          <input id="inputPhone" name="phone" type="tel" inputmode="tel" pattern="[0-9+()\s-]{6,}" required class="mt-1 block w-full rounded-2xl border px-4 py-3 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#1E3A8A]" placeholder="08x-xxx-xxxx">
          <p class="text-red-600 text-sm mt-1 font-bold">** ‡πÇ‡∏õ‡∏£‡∏î‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ **</p>
        </div>

        

        <div>
          <label class="block text-sm font-medium text-gray-700">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏∏‡∏à‡∏£‡∏¥‡∏ï <span class="text-red-600">*</span></label>

<div class="grid grid-cols-1 gap-3 mt-1">
  <!-- ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î -->
  <div>
    <label class="text-sm text-gray-700">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
    <select id="province" name="province" required class="mt-1 block w-full rounded-2xl border px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[#1E3A8A]">
      <option value="">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î...</option>
    </select>
  </div>

  <!-- ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ -->
  <div>
    <label class="text-sm text-gray-700">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</label>
    <select id="district" name="district" required class="mt-1 block w-full rounded-2xl border px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[#1E3A8A]">
      <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ --</option>
    </select>
  </div>

  <!-- ‡∏ï‡∏≥‡∏ö‡∏• -->
  <div>
    <label class="text-sm text-gray-700">‡∏ï‡∏≥‡∏ö‡∏•</label>
    <select id="subdistrict" name="subdistrict" required class="mt-1 block w-full rounded-2xl border px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[#1E3A8A]">
      <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡∏ö‡∏• --</option>
    </select>
  </div>
</div>

        <!-- OpenAI Chatbot UI integrated -->
<div>
  <label class="block text-sm font-medium text-gray-700">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏∏‡∏à‡∏£‡∏¥‡∏ï (‡∏£‡∏∞‡∏ö‡∏ö AI ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå)<span class="text-red-600">*</span></label>

  <div id="aiChatContainer" class="mt-3 w-full rounded-2xl border shadow-md overflow-hidden">
    <!-- Chatbot HTML from index.txt -->
    <div class="w-full bg-white rounded-xl overflow-hidden flex flex-col h-[320px]">
      <header class="p-3 bg-indigo-600 text-white shadow-md">
        <h1 class="text-base font-bold">üõ†Ô∏è ‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏à‡∏£‡∏¥‡∏ï (AI)</h1>
        <p class="text-xs opacity-90">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</p>
      </header>

      <div id="chat-output" class="flex-1 p-3 flex flex-col space-y-2 overflow-y-auto bg-gray-50"></div>

      <div class="p-3 border-t bg-white">
  <div class="flex flex-col gap-3">
    <textarea id="user-input" rows="3" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏∏‡∏à‡∏£‡∏¥‡∏ï..." class="w-full p-2 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500"></textarea>
    <button id="analyzeBtn" type="button" class="w-full py-3 rounded-2xl bg-indigo-600 hover:bg-indigo-700 text-white font-extrabold text-lg shadow">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</button>
    <button id="reportCorruptionBtn" type="button" class="w-full py-3 rounded-2xl bg-green-600 hover:bg-green-700 text-white font-extrabold text-lg shadow">‡πÅ‡∏à‡πâ‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏∏‡∏à‡∏£‡∏¥‡∏ï</button>
  </div>
</div>
      </div>
    </div>
  </div>
</div>

          <div id="locationInfo" class="mt-2 hidden text-sm text-gray-700 bg-green-50 border border-green-100 rounded-xl p-3">
            <div id="coordinates" class="font-medium"></div>
            <div id="geoText" class="text-xs text-gray-600 mt-1"></div>
          </div>
        </div>

        

      </form>

    </section>

    <!-- Tracking (hidden by default) -->
    <section id="userTrackingPage" class="hidden bg-white rounded-2xl shadow-2xl border border-gray-200 p-5 mb-5">
      <div class="mb-3"><h3 class="font-bold">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</h3><p class="text-sm text-gray-600">‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏</p></div>
      <div class="space-y-3">
        <input id="trackPhone" type="tel" class="w-full rounded-2xl border px-4 py-3" placeholder="08x-xxx-xxxx">
        <button id="trackBtn" class="w-full py-3 rounded-2xl bg-[#0EA5E9] hover:bg-blue-800 text-white font-semibold">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
        <div id="trackResults" class="space-y-3"></div>
        <button id="backToReportBtn" class="text-sm text-gray-600 underline">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</button>
      </div>
    </section>

    <!-- Admin (login + dashboard) -->
    <section id="loginPage" class="hidden bg-white rounded-2xl shadow-2xl border border-gray-200 p-5 mb-5">
      <h3 class="font-bold mb-3">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•</h3>
      <form id="loginForm" class="space-y-3">
        <input name="email" type="email" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•" class="w-full rounded-2xl border px-4 py-3" required>
        <input name="password" type="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" class="w-full rounded-2xl border px-4 py-3" required>
        <button class="w-full py-3 rounded-2xl bg-gray-800 text-white font-semibold">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
      </form>
    </section>

    <section id="adminDashboard" class="hidden">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-bold">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î ‚Äî ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ö‡∏≤‡∏∞‡πÅ‡∏™</h3>
        <div class="flex gap-2 ml-auto">
  
  <button id="downloadReports" class="px-3 py-2 rounded-xl bg-blue-600 text-white">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
          
          
          <button id="logoutBtn" class="px-3 py-2 rounded-xl bg-gray-700 text-white">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
        </div>
      </div>

      <div id="reportsList" class="space-y-3"></div>
    </section>

  </main>

  <div id="modalRoot"></div>

<!-- Download Date Range Modal -->
<div id="downloadModal" class="fixed inset-0 bg-black/40 hidden items-center justify-center z-50 p-4">
  <div class="bg-white rounded-2xl p-5 max-w-md w-full shadow-2xl">
    <h3 class="text-lg font-bold mb-3">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</h3>
    <div class="space-y-3">
      <div>
        <label class="text-sm font-semibold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label>
        <input type="date" id="downloadStart" class="mt-1 w-full rounded-xl border px-3 py-2" />
      </div>
      <div>
        <label class="text-sm font-semibold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label>
        <input type="date" id="downloadEnd" class="mt-1 w-full rounded-xl border px-3 py-2" />
      </div>
    </div>
    <div class="flex justify-end gap-2 mt-4">
      <button id="closeDownloadModal" class="px-3 py-2 rounded-xl bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
      <button id="confirmDownload" class="px-3 py-2 rounded-xl bg-blue-600 text-white">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</button>
    </div>
  </div>
</div>
  <div id="toast" class="toast bg-black/80 rounded-xl"></div>
<script>
// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
(function(){
  function generateCaseId(){
    // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: CASE-<time36>-<RND4> ‡πÄ‡∏ä‡πà‡∏ô CASE-K5X9Z-7A9B
    const timePart = Date.now().toString(36).toUpperCase();
    const rnd = Math.random().toString(36).substring(2,8).toUpperCase();
    return 'CASE-' + timePart.slice(-6) + '-' + rnd.slice(0,4);
  }

  document.addEventListener('DOMContentLoaded', function(){
    const display = document.getElementById('caseIdDisplay');
    const input = document.getElementById('caseIdInput');
    if(display && input){
      const id = generateCaseId();
      display.value = id;
      input.value = id;
      display.setAttribute('readonly','readonly');
    }

    const form = document.getElementById('emergencyForm');
    if(form){
      form.addEventListener('submit', function(e){
        const current = document.getElementById('caseIdInput');
        if(!current.value){
          current.value = generateCaseId();
        }
      });
    }
  });
})();
// ‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô ‡∏ä‡∏∑‡πà‡∏≠ ‡πÅ‡∏•‡∏∞ ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ ‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏±‡∏ß‡∏ï‡∏ô
(function(){
  document.addEventListener('DOMContentLoaded', function(){
    const radioYes = document.querySelector('input[name="identify"][value="yes"]');
    const radioNo  = document.querySelector('input[name="identify"][value="no"]');
    const nameField = document.getElementById('inputName').closest('div');
    const phoneField = document.getElementById('inputPhone').closest('div');

    function updateVisibility(){
      if(radioNo.checked){
        nameField.classList.add('hidden');
        phoneField.classList.add('hidden');
        document.getElementById('inputName').required = false;
        document.getElementById('inputPhone').required = false;
      } else {
        nameField.classList.remove('hidden');
        phoneField.classList.remove('hidden');
        document.getElementById('inputName').required = true;
        document.getElementById('inputPhone').required = true;
      }
    }

    if(radioYes && radioNo){
      radioYes.addEventListener('change', updateVisibility);
      radioNo.addEventListener('change', updateVisibility);
    }
  });
})();

</script>
